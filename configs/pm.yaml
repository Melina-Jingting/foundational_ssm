wandb:
  project: foundational_ssm_downstream_pm
  tags: [neural, behavior, masking]
  entity: melinajingting-ucl
  resume_run_id: null 

dataset:
  cfg: 
  - selection:
    - brainset: perich_miller_population_2018
      sessions:
        - t_20130819_center_out_reaching
  skip_timesteps: 56

train_loader:
  dataset_args:
    keep_files_open: false
    lazy: true
    split: train
  sampler: RandomFixedWindowSampler
  sampler_args:
    drop_short: false
    window_length: 3.28
    min_window_length: 1.28
  dataloader_args:
    batch_size: 64
    num_workers: 3
    persistent_workers: true
  sampling_rate: 200

val_loader:
  dataset_args:
    keep_files_open: false
    lazy: true
    split: val_trial
  sampler: SequentialFixedWindowSampler
  sampler_args:
    drop_short: false
    window_length: 3.280
    min_window_length: 1.28
  dataloader_args:
    batch_size: 64
    num_workers: 0
    persistent_workers: false
  sampling_rate: 200

model:
  input_dim: 72
  ssm_io_dim: 256
  ssm_dim: 128
  ssm_init_diag_blocks: 4
  ssm_num_layers: 2
  output_dim: 2
  rng_seed: 42
  dt_min: 0.001
  dt_max: 0.01
  dropout_p: 0.03
  ssm_dropout_p: 0.03

optimizer:
  lr: 0.002
  weight_decay: 0.01
  mode: all

training:
  epochs: 1001
  log_val_every: 100
  save_checkpoints: true
  checkpoint_every: 100
  from_scratch: true

rng_seed: 42
input_dim: 625