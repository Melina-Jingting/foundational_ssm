# Wandb sweep configuration
program: scripts/training/downstream_brainset.py
method: grid
metric:
  name: final/best_r2
  goal: maximize
run_cap: 20  # Limit total number of runs
early_terminate:
  type: hyperband
  min_iter: 10
parameters:
  dataset_args.recording_id:
    values: [perich_miller_population_2018/t_20130819_center_out_reaching, perich_miller_population_2018/t_20130820_random_target_reaching]
  prepend_history:
    values: [0, 0.1, 0.2, 0.3, 0.4, 0.5]
  train_loader.sampler_args.max_window_length:
    values: [1, 3, 5]
  optimizer.mode:
    values: [all]
  model.ssm_dim:
    values: [128]
  model.ssm_io_dim:
    values: [256]
  model.ssm_num_layers:
    values: [2]
  optimizer.lr:
    values: [0.002, 0.003, 0.004]
  optimizer.weight_decay:
    values: [0.03]
  model.dropout_p:
    values: [0.03]

# Fixed parameters (not swept)
wandb:
  project: foundational_ssm_pm_sweep
  tags: [neural, behavior, downstream, decoding, sweep]
  entity: melinajingting-ucl
  run_prefix: sweep_pm
